<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Board</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        * { box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
        }
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .glass-strong {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        .glow { box-shadow: 0 0 40px rgba(139, 92, 246, 0.3); }
        .glow-success { box-shadow: 0 0 30px rgba(16, 185, 129, 0.4); }
        .task-item { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .task-item:hover { transform: translateX(8px); background: rgba(255, 255, 255, 0.08); }
        .gradient-text {
            background: linear-gradient(135deg, #a78bfa 0%, #ec4899 50%, #f97316 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .progress-glow { box-shadow: 0 0 20px rgba(139, 92, 246, 0.5); }
        .btn-gradient {
            background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
            transition: all 0.3s ease;
        }
        .btn-gradient:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4); }
        .btn-gradient:disabled { opacity: 0.5; transform: none; box-shadow: none; }
        .checkbox-custom {
            appearance: none; width: 24px; height: 24px;
            border: 2px solid rgba(139, 92, 246, 0.5); border-radius: 6px;
            background: transparent; cursor: pointer; transition: all 0.3s ease; position: relative;
        }
        .checkbox-custom:checked { background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); border-color: transparent; }
        .checkbox-custom:checked::after {
            content: 'âœ“'; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); color: white; font-size: 14px; font-weight: bold;
        }
        .checkbox-custom:hover { border-color: #a78bfa; box-shadow: 0 0 15px rgba(139, 92, 246, 0.3); }
        .quote-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);
            border: 1px solid rgba(139, 92, 246, 0.2);
        }
        .floating { animation: floating 3s ease-in-out infinite; }
        @keyframes floating { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        .pulse-ring { animation: pulse-ring 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse-ring { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .slide-in { animation: slideIn 0.4s ease-out forwards; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        .input-glow:focus { box-shadow: 0 0 25px rgba(139, 92, 246, 0.3); }
        .delete-btn { opacity: 0; transition: all 0.2s ease; }
        .task-item:hover .delete-btn { opacity: 1; }
    </style>
</head>
<body class="text-white">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        const API_BASE = '/api';
        
        const motivationalQuotes = [
            { text: "The secret of getting ahead is getting started.", author: "Mark Twain" },
            { text: "It always seems impossible until it's done.", author: "Nelson Mandela" },
            { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
            { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
            { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
            { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
            { text: "Your time is limited, don't waste it living someone else's life.", author: "Steve Jobs" },
            { text: "The future depends on what you do today.", author: "Mahatma Gandhi" },
            { text: "Done is better than perfect.", author: "Sheryl Sandberg" },
            { text: "Small progress is still progress.", author: "Unknown" },
            { text: "Focus on being productive instead of busy.", author: "Tim Ferriss" },
            { text: "Start where you are. Use what you have. Do what you can.", author: "Arthur Ashe" }
        ];
        
        function triggerConfetti() {
            const count = 200;
            const defaults = { origin: { y: 0.7 }, zIndex: 9999 };
            function fire(particleRatio, opts) {
                confetti({ ...defaults, ...opts, particleCount: Math.floor(count * particleRatio) });
            }
            fire(0.25, { spread: 26, startVelocity: 55, colors: ['#a78bfa', '#ec4899', '#f97316'] });
            fire(0.2, { spread: 60, colors: ['#8b5cf6', '#d946ef', '#f472b6'] });
            fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8, colors: ['#c084fc', '#e879f9', '#fb7185'] });
            fire(0.1, { spread: 120, startVelocity: 25, decay: 0.92, scalar: 1.2, colors: ['#a855f7', '#ec4899', '#f43f5e'] });
            fire(0.1, { spread: 120, startVelocity: 45, colors: ['#7c3aed', '#db2777', '#ea580c'] });
        }
        
        function App() {
            const [tasks, setTasks] = useState([]);
            const [newTaskTitle, setNewTaskTitle] = useState('');
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [submitting, setSubmitting] = useState(false);
            const [quote, setQuote] = useState(motivationalQuotes[0]);
            
            useEffect(() => {
                const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
                setQuote(randomQuote);
            }, []);
            
            const fetchTasks = useCallback(async () => {
                try {
                    const response = await fetch(`${API_BASE}/tasks`);
                    if (!response.ok) throw new Error('Failed to fetch tasks');
                    const data = await response.json();
                    setTasks(data);
                    setError(null);
                } catch (err) { setError('Could not load tasks. Please try again.'); }
                finally { setLoading(false); }
            }, []);
            
            useEffect(() => { fetchTasks(); }, [fetchTasks]);
            
            const addTask = async (e) => {
                e.preventDefault();
                if (!newTaskTitle.trim() || submitting) return;
                setSubmitting(true);
                try {
                    const response = await fetch(`${API_BASE}/tasks`, {
                        method: 'POST', headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ title: newTaskTitle })
                    });
                    if (!response.ok) throw new Error('Failed to add task');
                    const task = await response.json();
                    setTasks(prev => [task, ...prev]);
                    setNewTaskTitle('');
                    setError(null);
                } catch (err) { setError('Could not add task. Please try again.'); }
                finally { setSubmitting(false); }
            };
            
            const toggleTask = async (taskId, completed) => {
                try {
                    const response = await fetch(`${API_BASE}/tasks/${taskId}`, {
                        method: 'PATCH', headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ completed: !completed })
                    });
                    if (!response.ok) throw new Error('Failed to update task');
                    const updatedTask = await response.json();
                    setTasks(prev => prev.map(t => t.id === taskId ? updatedTask : t));
                    if (!completed) { triggerConfetti(); }
                } catch (err) { setError('Could not update task. Please try again.'); }
            };
            
            const deleteTask = async (taskId) => {
                try {
                    const response = await fetch(`${API_BASE}/tasks/${taskId}`, { method: 'DELETE' });
                    if (!response.ok) throw new Error('Failed to delete task');
                    setTasks(prev => prev.filter(t => t.id !== taskId));
                } catch (err) { setError('Could not delete task. Please try again.'); }
            };
            
            const completedCount = tasks.filter(t => t.completed).length;
            const totalCount = tasks.length;
            const progressPercent = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
            
            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="relative">
                            <div className="w-16 h-16 border-4 border-purple-500/30 rounded-full"></div>
                            <div className="w-16 h-16 border-4 border-transparent border-t-purple-500 rounded-full animate-spin absolute top-0 left-0"></div>
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="max-w-2xl mx-auto px-4 py-8 md:py-12">
                    <div className="text-center mb-8">
                        <div className="inline-block floating mb-4">
                            <div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center glow">
                                <svg className="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                                </svg>
                            </div>
                        </div>
                        <h1 className="text-4xl md:text-5xl font-bold gradient-text mb-2">Task Board</h1>
                        <p className="text-gray-400 text-lg">Crush your goals, one task at a time</p>
                    </div>
                    
                    <div className="quote-card rounded-2xl p-5 mb-6 slide-in">
                        <div className="flex items-start gap-3">
                            <div className="text-3xl">âœ¨</div>
                            <div>
                                <p className="text-gray-200 italic text-lg leading-relaxed">"{quote.text}"</p>
                                <p className="text-purple-400 mt-2 font-medium">â€” {quote.author}</p>
                            </div>
                        </div>
                    </div>
                    
                    {error && (<div className="glass border-l-4 border-red-500 p-4 mb-6 rounded-xl"><p className="text-red-400">{error}</p></div>)}
                    
                    <div className="glass-strong rounded-2xl p-6 mb-6 glow">
                        <form onSubmit={addTask} className="flex gap-3">
                            <input type="text" value={newTaskTitle} onChange={(e) => setNewTaskTitle(e.target.value)}
                                placeholder="What's on your mind today?"
                                className="flex-1 px-5 py-4 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-purple-500/50 input-glow transition-all"
                                disabled={submitting} />
                            <button type="submit" disabled={!newTaskTitle.trim() || submitting} className="px-6 py-4 btn-gradient text-white rounded-xl font-semibold">
                                {submitting ? (<div className="w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>) : (
                                    <span className="flex items-center gap-2">
                                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                                        </svg>Add
                                    </span>
                                )}
                            </button>
                        </form>
                    </div>
                    
                    {totalCount > 0 && (
                        <div className="glass rounded-2xl p-6 mb-6">
                            <div className="flex items-center justify-between mb-4">
                                <div className="flex items-center gap-3">
                                    <div className={`w-3 h-3 rounded-full ${progressPercent === 100 ? 'bg-green-500' : 'bg-purple-500'} pulse-ring`}></div>
                                    <span className="text-sm font-medium text-gray-300">Progress</span>
                                </div>
                                <span className={`text-2xl font-bold ${progressPercent === 100 ? 'text-green-400' : 'gradient-text'}`}>{progressPercent}%</span>
                            </div>
                            <div className="w-full bg-white/5 rounded-full h-4 overflow-hidden">
                                <div className={`h-4 rounded-full transition-all duration-700 ease-out ${progressPercent === 100 ? 'bg-gradient-to-r from-green-500 to-emerald-400 glow-success' : 'bg-gradient-to-r from-purple-500 via-pink-500 to-orange-400 progress-glow'}`}
                                    style={{ width: `${progressPercent}%` }}></div>
                            </div>
                            <div className="flex justify-between mt-3">
                                <p className="text-sm text-gray-400">{completedCount} of {totalCount} completed</p>
                                {progressPercent === 100 && (<p className="text-sm text-green-400 font-medium flex items-center gap-1"><span>ðŸŽ‰</span> All done!</p>)}
                            </div>
                        </div>
                    )}
                    
                    <div className="glass rounded-2xl overflow-hidden">
                        {tasks.length === 0 ? (
                            <div className="p-12 text-center">
                                <div className="w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 flex items-center justify-center">
                                    <svg className="w-10 h-10 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                                    </svg>
                                </div>
                                <h3 className="text-xl font-semibold text-white mb-2">No tasks yet</h3>
                                <p className="text-gray-400">Add your first task and start being productive!</p>
                            </div>
                        ) : (
                            <ul className="divide-y divide-white/5">
                                {tasks.map((task, index) => (
                                    <li key={task.id} className="task-item flex items-center gap-4 p-5" style={{ animationDelay: `${index * 50}ms` }}>
                                        <input type="checkbox" checked={task.completed} onChange={() => toggleTask(task.id, task.completed)} className="checkbox-custom flex-shrink-0" />
                                        <span className={`flex-1 text-lg transition-all duration-300 ${task.completed ? 'line-through text-gray-500' : 'text-gray-100'}`}>{task.title}</span>
                                        {task.completed && (<span className="text-xs bg-green-500/20 text-green-400 px-2 py-1 rounded-full">Done</span>)}
                                        <button onClick={() => deleteTask(task.id)} className="delete-btn p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-all" title="Delete task">
                                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                            </svg>
                                        </button>
                                    </li>
                                ))}
                            </ul>
                        )}
                    </div>
                    
                    <div className="text-center mt-8">
                        <p className="text-gray-500 text-sm">Built with <span className="text-purple-400">FastAPI</span> + <span className="text-pink-400">React</span></p>
                        <p className="text-gray-600 text-xs mt-1">Complete a task to see the magic âœ¨</p>
                    </div>
                </div>
            );
        }
        
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
